(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{6803:function(t,a,s){"use strict";s.r(a);var e=function(){var t=this,a=t.$createElement,s=t._self._c||a;return t.userLogged&&t.allLoaded?s("q-page",[t.userLogged&&t.boardContractsLoaded?s("div",{staticClass:"flex column justify-center items-center q-pt-md"},[s("div",{staticClass:"flex items-center"},[s("h5",{staticClass:"text-center no-margin"},[t._v("Lista appalti")]),s("q-input",{staticClass:"col-12 col-md-3 q-ml-md",attrs:{outlined:"",type:"text",label:"Filtra per tipologia o regione"},model:{value:t.searchString,callback:function(a){t.searchString=a},expression:"searchString"}}),t.userLogged.admin?s("q-btn",{staticClass:"q-ml-md",attrs:{round:"",flat:"",icon:"add",color:"accent"},on:{click:function(a){t.openModal("load-contract","Carica Appalto",!0,t.loadContractClassObj,!1),t.selectedContract=null}}}):t._e()],1),t._l(t.contractList,(function(a,e){return s("contract-card",{key:e,staticClass:"q-mb-md",attrs:{contract:a,index:e},on:{modifyContract:t.modifyContract}})}))],2):t._e(),t.userLogged.admin&&!t.boardContractsLoaded?s("div",{staticClass:"flex column justify-center items-center q-pt-xl"},[s("h5",{staticClass:"text-center no-margin q-pb-lg"},[t._v("Ancora nessun appalto caricato")]),s("q-btn",{attrs:{push:"",label:"Carica appalto",color:"accent"},on:{click:function(a){return t.openModal("load-contract","Carica Appalto",!0,t.loadContractClassObj,!1)}}})],1):t._e(),t.userLogged.admin||t.boardContractsLoaded?t._e():s("div",{staticClass:"flex column justify-center items-center q-pt-xl"},[s("h5",{staticClass:"text-center no-margin q-pb-lg"},[t._v("Ancora nessun appalto caricato")])]),s("modal",{attrs:{"class-obj":t.classObj,modal:t.modal,"is-maximized":t.isMaximized,component:t.modalComponent,title:t.modalTitle,"selected-contract":t.selectedContract},on:{"update:modal":function(a){t.modal=a}}})],1):t._e()},o=[],c=(s("e6cf"),s("ded3")),i=s.n(c),n=s("2f62"),r=s("714b"),l=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("q-card",{staticClass:"my-card",staticStyle:{"min-width":"60%"}},[s("q-card-section",{staticClass:"relative-position",staticStyle:{"overflow-wrap":"break-word"}},[t.userLogged.admin?s("q-btn",{staticClass:"absolute-top-right",attrs:{round:"",flat:"",icon:"fas fa-trash-alt",color:"negative"},on:{click:t.removeContract}}):t._e(),t.userLogged.admin?s("q-btn",{staticClass:"absolute-top-right q-mr-xl",attrs:{round:"",flat:"",icon:"fas fa-pencil-alt",color:"primary"},on:{click:t.modifyContract}}):t._e(),s("div",{staticClass:"q-pb-md"},[s("span",{staticClass:"text-body1 text-weight-medium"},[t._v("Ente: ")]),s("span",{staticClass:"text-body2"},[t._v(t._s(t.contract.entity))])]),s("div",{staticClass:"q-pb-md"},[s("span",{staticClass:"text-body1 text-weight-medium"},[t._v("Tipologia: ")]),s("span",{staticClass:"text-body2"},[t._v(t._s(t.contract.typology))])]),s("div",{staticClass:"q-pb-md"},[s("span",{staticClass:"text-body1 text-weight-medium"},[t._v("Procedura: ")]),s("span",{staticClass:"text-body2"},[t._v(t._s(t.contract.procedure))])]),s("div",{staticClass:"q-pb-md"},[s("span",{staticClass:"text-body1 text-weight-medium"},[t._v("Oggetto: ")]),s("span",{staticClass:"text-body2"},[t._v(t._s(t.contract.subject))])]),s("div",{staticClass:"q-pb-md"},[s("span",{staticClass:"text-body1 text-weight-medium"},[t._v("Importo: ")]),s("span",{staticClass:"text-body2"},[t._v(t._s(t.contract.amount))])]),s("div",{staticClass:"flex q-pb-md"},[s("div",[s("span",{staticClass:"text-body1 text-weight-medium"},[t._v("Regione: ")]),s("span",{staticClass:"text-body2"},[t._v(t._s(t.contract.region))])]),s("div",{staticClass:"q-ml-xl"},[s("span",{staticClass:"text-body1 text-weight-medium"},[t._v("Luogo: ")]),s("span",{staticClass:"text-body2"},[t._v(t._s(t.contract.place))])])]),s("div",{staticClass:"q-pb-md"},[s("span",{staticClass:"text-body1 text-weight-medium"},[t._v("Categoria: ")]),s("span",{staticClass:"text-body2"},[t._v(t._s(t.contract.category))])]),s("div",{staticClass:"q-pb-md"},[s("span",{staticClass:"text-body1 text-weight-medium"},[t._v("Scadenza: ")]),s("span",{staticClass:"text-body2"},[t._v(t._s(t.date.formatDate(t.contract.expirationDate,"DD-MM-YYYY")))])]),s("div",[s("span",{staticClass:"text-body1 text-weight-medium"},[t._v("Link: ")]),s("a",{staticClass:"text-body2",attrs:{href:t.contract.link,target:"_blank"}},[t._v("Clicca per aprire il link")])])],1)],1)},d=[],m=s("bd4c"),C={name:"ContractCard",props:["contract","index"],data(){return{date:m["b"]}},computed:i()({},Object(n["c"])({userLogged:"user"})),methods:i()(i()({},Object(n["b"])(["deleteContract","fetchAllContracts"])),{},{async removeContract(){this.$q.loading.show();const t={pathParam:this.contract._id};await this.deleteContract(t),await this.fetchAllContracts(),this.$q.loading.hide()},modifyContract(){this.$emit("modifyContract",this.contract)}})},p=C,h=s("2877"),b=s("f09f"),g=s("a370"),u=s("9c40"),x=s("eebe"),f=s.n(x),v=Object(h["a"])(p,l,d,!1,null,"afe66610",null),_=v.exports;f()(v,"components",{QCard:b["a"],QCardSection:g["a"],QBtn:u["a"]});var y={name:"Contract",components:{ContractCard:_,Modal:r["a"]},data(){return{allLoaded:!1,boardContractsLoaded:!1,modalComponent:void 0,modalTitle:void 0,isMaximized:!1,selectedContract:null,modal:!1,searchString:"",classObj:{},contractList:[],loadContractClassObj:{"q-pa-none":!0}}},computed:i()({},Object(n["c"])({userLogged:"user",boardContracts:"boardContracts"})),methods:i()(i()({},Object(n["b"])(["fetchAllContracts","fetchUser"])),{},{modifyContract(t){console.log("ciao",t),this.selectedContract=t,this.openModal("load-contract","Modifica Appalto",!0,this.loadContractClassObj,!1)},async loadContracts(){this.userLogged&&(await this.fetchAllContracts(),this.boardContractsLoaded=this.boardContracts.length>0,this.allLoaded=!0),this.$q.loading.hide()},openModal(t,a,s,e){this.modalComponent=t,this.modalTitle=a,this.isMaximized=s,this.modal=!0,this.classObj=e}}),watch:{boardContracts:{deep:!0,handler(t,a){t.length!==a.length&&(this.boardContractsLoaded=t.length>0,this.contractList=this.boardContracts)}},searchString:{deep:!0,handler(t,a){t.length!==a.length&&""!==t&&(this.contractList=this.boardContracts.filter((a=>a.region===t||a.typology===t))),""===t&&(this.contractList=this.boardContracts)}}},async mounted(){if(this.$q.loading.show(),!this.userLogged){const t=window.localStorage.getItem("userId");if(t){const a={pathParam:t};await this.fetchUser(a)}}await this.loadContracts()}},q=y,w=s("9989"),L=s("27f9"),j=Object(h["a"])(q,e,o,!1,null,"87998770",null);a["default"]=j.exports;f()(j,"components",{QPage:w["a"],QInput:L["a"],QBtn:u["a"]})}}]);